
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Consulta Profissional - Protocolo TRIPE</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #ef4444; --bg: #050505; --card: #111111; --text: #ffffff; --muted: #9ca3af; --border: #262626; }
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg ); color: var(--text); min-height: 100vh; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; }
        .quiz-card { width: 100%; max-width: 550px; background: var(--card); border: 1px solid var(--border); border-radius: 24px; padding: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.6); text-align: center; }
        .fixed-header { font-size: 10px; font-weight: 900; color: var(--primary); text-transform: uppercase; letter-spacing: 2px; margin-bottom: 20px; }
        .headline { font-size: 22px; font-weight: 900; color: #fff; margin-bottom: 15px; line-height: 1.2; text-transform: uppercase; }
        .sub-headline { font-size: 14px; color: var(--primary); font-weight: 700; margin-bottom: 20px; }
        .video-container { position: relative; background: #000; border-radius: 16px; overflow: hidden; margin-bottom: 25px; border: 1px solid var(--border); width: 100%; }
        .video-container.sticky { position: fixed; top: 0; left: 0; right: 0; z-index: 9999; margin: 0; border-radius: 0; max-width: 100%; }
        .video-placeholder { display: none; }
        .video-placeholder.show { display: block; padding-bottom: 56.25%; }
        .btn-next { background: var(--primary); color: white; border: none; padding: 22px; border-radius: 14px; font-weight: 900; cursor: pointer; width: 100%; font-size: 20px; text-transform: uppercase; transition: all 0.3s; box-shadow: 0 10px 20px rgba(239, 68, 68, 0.3); position: sticky; bottom: 0; z-index: 999; }
        .btn-next:hover { transform: scale(1.02); }
        .screen { display: none; }
        .screen.active { display: block; }
        .progress-bar { height: 4px; background: var(--border); border-radius: 10px; margin-bottom: 30px; overflow: hidden; }
        .progress-fill { height: 100%; background: var(--primary); width: 0%; transition: width 0.3s ease; }
        .options-grid { display: grid; gap: 12px; margin-bottom: 25px; }
        .option-btn { background: var(--card); border: 2px solid var(--border); color: var(--text); padding: 16px; border-radius: 12px; cursor: pointer; font-weight: 600; transition: all 0.2s; }
        .option-btn:hover { border-color: var(--primary); background: rgba(239, 68, 68, 0.1); }
        .urgency-badge { background: rgba(34, 197, 94, 0.2); border: 2px solid #22c55e; padding: 10px 15px; border-radius: 50px; display: inline-block; margin-bottom: 20px; font-weight: 900; color: #22c55e; font-size: 12px; }
        .carousel { width: 100%; height: 250px; background: #000; border-radius: 15px; margin: 15px 0; overflow: hidden; position: relative; border: 1px solid var(--border); }
        .slide { position: absolute; inset: 0; opacity: 0; transition: opacity 0.6s ease; display: flex; align-items: center; justify-content: center; }
        .slide.active { opacity: 1; }
        .slide img { width: 100%; height: 100%; object-fit: contain; }
        .slide-caption { position: absolute; bottom: 10px; left: 10px; right: 10px; background: rgba(0,0,0,0.8); padding: 8px; border-radius: 8px; font-size: 11px; font-weight: 700; color: #22c55e; border: 1px solid rgba(34, 197, 94, 0.3); text-align: center; z-index: 10; }
        .analysis-item { margin-bottom: 20px; text-align: left; }
        .analysis-label { font-size: 12px; font-weight: 700; margin-bottom: 5px; display: flex; justify-content: space-between; }
        .progress-container { width: 100%; height: 12px; background: #222; border-radius: 10px; overflow: hidden; border: 1px solid #333; }
        .progress-bar-fill { height: 100%; width: 0%; background: var(--primary); transition: width 0.5s ease, background 0.3s ease; }
        .progress-bar-fill.complete { background: #22c55e; }
        .status-tag { font-size: 10px; padding: 2px 6px; border-radius: 4px; background: #333; }
        .status-tag.complete { background: #22c55e; color: #000; }
        .benefit-list { text-align: left; margin: 20px 0; }
        .benefit-item { display: flex; align-items: center; margin-bottom: 12px; font-size: 14px; font-weight: 800; color: #fff; text-transform: uppercase; }
        .benefit-item span { color: #22c55e; margin-right: 10px; font-size: 18px; }
        .guarantee-box { display: flex; align-items: center; justify-content: center; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; margin: 20px 0; border: 1px dashed #444; }
        .guarantee-badge { width: 50px; margin-right: 15px; }
        .guarantee-text { text-align: left; font-size: 12px; line-height: 1.3; }
    </style>
</head>
<body>
    <div class="quiz-card">
        <!-- Tela 1: Mini VSL Wistia -->
        <div id="s-0" class="screen active">
            <div class="fixed-header">PROTOCOLO TRIPE - REVELADO</div>
            <h1 class="headline">O SEGREDO DOS ATORES P√îRNO PARA ATIVAR O CRESCIMENTO DO P√äNIS EM 45 DIAS.</h1>
            <p class="sub-headline">Assista ao v√≠deo abaixo para liberar sua üëáavalia√ß√£o gratuitaüëá</p>
            <div class="video-placeholder"></div>
            <div class="video-container" id="video-container">
              <script src="https://fast.wistia.com/embed/medias/kf6oec0viz.jsonp" async></script>
              <script src="https://fast.wistia.com/assets/external/E-v1.js" async></script>
              <div class="wistia_responsive_padding" style="padding:56.25% 0 0 0;position:relative;">
                <div class="wistia_responsive_wrapper" style="height:100%;left:0;position:absolute;top:0;width:100%;">
                  <div class="wistia_embed wistia_async_kf6oec0viz videoFoam=true" style="height:100%;position:relative;width:100%">
                    <div class="wistia_swatch" style="height:100%;left:0;opacity:0;overflow:hidden;position:absolute;top:0;transition:opacity 200ms;width:100%;">
                      <img src="https://fast.wistia.com/embed/medias/kf6oec0viz/swatch" style="filter:blur(5px);height:100%;object-fit:contain;width:100%;" alt="" aria-hidden="true" onload="this.parentNode.style.opacity=1;" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <button id="vsl-button" class="btn-next" onclick="next()">REVELAR O SEGREDO</button>
        </div>

        <!-- Tela 2: Modal de Autoridade -->
        <div id="s-1" class="screen">
            <div class="fixed-header">CONSULTA PROFISSIONAL GRATUITA</div>
            <h2 style="font-size: 22px; font-weight: 900; margin-bottom: 15px;">CLIQUE AGORA PARA FAZER SUA AVALIA√á√ÉO GRATUITA</h2>
            <div class="urgency-badge"><span id="online-count-val">147</span> HOMENS ONLINE AGORA</div>
            <div class="carousel" id="authority-carousel">
                <div class="slide active">
                    <img src="https://metodotripe.shop/wp-content/uploads/2026/02/02-.jpg" alt="Paciente M. Souza">
                    <div class="slide-caption">PACIENTE M. SOUZA: +5.8cm (VALIDADO )</div>
                </div>
                <div class="slide">
                    <img src="https://metodotripe.shop/wp-content/uploads/2026/01/22109742.jpg" alt="Paciente R. Oliveira">
                    <div class="slide-caption">PACIENTE R. OLIVEIRA: +4.9cm (VALIDADO )</div>
                </div>
                <div class="slide">
                    <img src="https://metodotripe.shop/wp-content/uploads/2026/01/meaSaaTbaAaaaamhD_iLJzfk9u2QO-ZC1.jpg" alt="Estudo Cl√≠nico">
                    <div class="slide-caption">ESTUDO CL√çNICO: EXPANS√ÉO TECIDUAL ATIVA</div>
                </div>
            </div>
            <p style="color: var(--muted ); margin-bottom: 25px;" id="loading-text">Carregando avalia√ß√£o gratuita...</p>
            <button class="btn-next" onclick="next()" id="start-quiz-btn" disabled>INICIAR AVALIA√á√ÉO AGORA</button>
        </div>

        <!-- Tela 3: Quiz Profissional (15 Perguntas) -->
        <div id="s-2" class="screen">
            <div class="fixed-header">AVALIA√á√ÉO CL√çNICA - ETAPA <span id="q-num">1</span>/15</div>
            <div class="progress-bar"><div class="progress-fill" id="p-fill"></div></div>
            <div id="q-box"></div>
        </div>

        <!-- Tela 4: Processamento de Resultados -->
        <div id="s-3" class="screen">
            <div class="fixed-header">SISTEMA DE DIAGN√ìSTICO AVAN√áADO</div>
            <h2 style="font-size: 22px; font-weight: 900; margin-bottom: 15px;">ANALISANDO DADOS BIOM√âTRICOS...</h2>
            <div class="carousel" id="depo-carousel">
                <div class="slide active">
                    <img src="https://metodotripe.shop/wp-content/uploads/2026/02/PACIENTE-H-2990-ANTES-E-DEPOIS-1-1-scaled-1.webp" alt="Paciente H. Lima">
                    <div class="slide-caption">PACIENTE H. LIMA: +5.2cm (CONFIRMADO )</div>
                </div>
                <div class="slide">
                    <img src="https://metodotripe.shop/wp-content/uploads/2026/02/daf6ef_d639bfc5b0a34189b18c48e3f54f2763_mv2-1.png" alt="Paciente A. Costa">
                    <div class="slide-caption">PACIENTE A. COSTA: +6.1cm (CONFIRMADO )</div>
                </div>
                <div class="slide">
                    <img src="https://metodotripe.shop/wp-content/uploads/2026/01/WhatsApp-Image-2024-12-18-at-15.11.46-rcl53qv1p0gr5s3fzr30gvvchnyybvpbhth13gqhj4.jpeg">
                    <div class="slide-caption">PACIENTE J. GOMES: +4.7cm (CONFIRMADO )</div>
                </div>
            </div>
            <div id="analysis-box" style="margin-top: 25px;">
                <div class="analysis-item">
                    <div class="analysis-label"><span>FLUXO SANGU√çNEO CAVERNOSO</span> <span id="st-1" class="status-tag">PROCESSANDO</span></div>
                    <div class="progress-container"><div id="pb-1" class="progress-bar-fill"></div></div>
                </div>
                <div class="analysis-item">
                    <div class="analysis-label"><span>DENSIDADE TECIDUAL</span> <span id="st-2" class="status-tag">AGUARDANDO</span></div>
                    <div class="progress-container"><div id="pb-2" class="progress-bar-fill"></div></div>
                </div>
                <div class="analysis-item">
                    <div class="analysis-label"><span>COMPATIBILIDADE PROTOCOLO</span> <span id="st-3" class="status-tag">AGUARDANDO</span></div>
                    <div class="progress-container"><div id="pb-3" class="progress-bar-fill"></div></div>
                </div>
            </div>
        </div>

        <!-- Tela 5: Bloco de Oferta Final -->
        <div id="s-4" class="screen">
            <div class="fixed-header">ACESSO LIBERADO AO PROTOCOLO</div>
            <h2 style="font-size: 22px; font-weight: 900; margin-bottom: 10px;">SEU PLANO PERSONALIZADO EST√Å PRONTO!</h2>
            
            <div class="benefit-list">
                <div class="benefit-item"><span>‚úì</span> AUMENTE O TAMANHO E GROSSURA NATURALMENTE</div>
                <div class="benefit-item"><span>‚úì</span> ERE√á√ïES MAIS DURADOURAS</div>
                <div class="benefit-item"><span>‚úì</span> PRIMEIROS RESULTADOS EM 45 DIAS</div>
                <div class="benefit-item"><span>‚úì</span> SEM APARELHOS OU REMEDIOS</div>
                <div class="benefit-item"><span>‚úì</span> FA√áA ELA GOZAR 3 VEZES POR NOITE</div>
                <div class="benefit-item"><span>‚úì</span> DURE ATE 3 HORAS NA CAMA</div>
            </div>

            <div class="guarantee-box">
                <img src="https://metodotripe.shop/wp-content/uploads/2026/02/7564b4c41b95c4d46ca0_-_94d8bd698ca2c759ce37_-_inserir-um-titulo.jpg" class="guarantee-badge">
                <div class="guarantee-text">
                    <p style="font-weight: 900; color: #fff;">M√âTODO TRIPE</p>
                    <p style="font-weight: 900; color: #22c55e;">30 DIAS DE GARANTIA</p>
                    <p style="color: var(--muted );">+ B√îNUS EXCLUSIVOS INCLUSOS</p>
                </div>
            </div>

            <button class="btn-next" onclick="finish()" style="margin-top: 10px;">GARANTIR MEU ACESSO AGORA</button>
            <p style="font-size: 10px; color: var(--muted); margin-top: 15px;">Compra 100% Segura e Sigilosa</p>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, set, update, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        const firebaseConfig = {
            apiKey: "AIzaSyCrUYYLb_9p4QUq1JLqQUwWEx-GgWEoTxQ",
            authDomain: "funil-tripe-v10.firebaseapp.com",
            databaseURL: "https://funil-tripe-v10-default-rtdb.firebaseio.com",
            projectId: "funil-tripe-v10",
            storageBucket: "funil-tripe-v10.firebasestorage.app",
            messagingSenderId: "872809369468",
            appId: "1:872809369468:web:e372a48b9654739098def9"
        };

        const QUESTIONS = [
            { id: 'idade', t: 'Qual sua faixa et√°ria? (Fator de risco vascular )', o: ['18-25', '26-35', '36-45', '46-55', '55+'] },
            { id: 'rigidez', t: 'Com que frequ√™ncia voc√™ atinge rigidez m√°xima do p√™nis?', o: ['Quase nunca', 'Raramente', '√Äs vezes', 'Frequentemente', 'Sempre'] },
            { id: 'manutencao', t: 'Consegue manter a ere√ß√£o at√© ejacular?', o: ['Tenho muita dificuldade', '√Äs vezes falha', 'Sim, sem problemas'] },
            { id: 'matinal', t: 'Voc√™ acorda com ere√ß√£o matinal?', o: ['Nunca', 'Raramente', 'Quase todos os dias'] },
            { id: 'circulacao', t: 'Sente as extremidades (m√£os/p√©s) frias com frequ√™ncia?', o: ['Sim, constantemente', '√Äs vezes', 'N√£o'] },
            { id: 'historico', t: 'Voc√™ tem hist√≥rico de Diabetes ou Press√£o Alta?', o: ['Sim, ambos', 'Sim, um deles', 'N√£o'] },
            { id: 'tamanho', t: 'Voc√™ percebeu alguma redu√ß√£o no tamanho do  p√™nis ao longo dos anos?', o: ['Sim, vis√≠vel', 'Talvez um pouco', 'N√£o'] },
            { id: 'estresse', t: 'Qual seu n√≠vel de estresse di√°rio?', o: ['Muito alto', 'Alto', 'Moderado', 'Baixo'] },
            { id: 'sono', t: 'Quantas horas de sono de qualidade voc√™ tem?', o: ['Menos de 5h', '5-6h', '7-8h', 'Mais de 8h'] },
            { id: 'libido', t: 'Como voc√™ avalia seu desejo sexual (libido)?', o: ['Muito baixo', 'Baixo', 'Normal', 'Alto'] },
            { id: 'vicios', t: 'Voc√™ fuma ou consome √°lcool em excesso?', o: ['Sim, ambos', 'Sim, um deles', 'N√£o'] },
            { id: 'medicamentos', t: 'Faz uso cont√≠nuo de algum medicamento?', o: ['Sim', 'N√£o'] },
            { id: 'exercicio', t: 'Qual sua frequ√™ncia de exerc√≠cios f√≠sicos?', o: ['Nunca', '1-2x/semana', '3-4x/semana', 'Diariamente'] },
            { id: 'recuperacao', t: 'Quanto tempo leva para ter uma segunda ere√ß√£o?', o: ['Mais de 1 hora', '30 minutos', '10-20 minutos', 'Quase imediato'] },
            { id: 'prioridade', t: 'Resolver este problema √© sua prioridade m√°xima?', o: ['Sim, urgente', 'Sim, mas posso esperar', 'Apenas curiosidade'] }
        ];

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const sid = 's_' + Date.now();
        let step = 0, qIdx = 0, stepStartTime = 0, avgHesitation = 0, hesitationCount = 0;

        window.next = () => {
            if (step === 0) { step = 1; update(ref(db, 'sessions/'+sid), { status: 'vsl_clicked' }); startModalDelay(); }
            else if (step === 1) { step = 2; update(ref(db, 'sessions/'+sid), { status: 'quiz_started' }); }
            else if (step === 2) { if (qIdx < 14) { qIdx++; } else { step = 3; startProcessing(); } }
            render();
        };

        window.sel = (id, val) => {
            const hesitation = Date.now() - stepStartTime;
            avgHesitation = (avgHesitation * hesitationCount + hesitation) / (hesitationCount + 1);
            hesitationCount++;
            update(ref(db, 'sessions/'+sid), { [id]: val, currentStep: qIdx + 1, avgHesitation: avgHesitation });
            window.next();
        };

        window.finish = () => { 
            update(ref(db, 'sessions/'+sid), { status: 'checkout_clicked' }); 
            window.location.href = `https://pay.wiapy.com/LJuEuullf4?utm_source=${sid}&external_id=${sid}`; 
        };

        function render( ) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById('s-' + step).classList.add('active');
            if (step === 2) {
                const q = QUESTIONS[qIdx];
                document.getElementById('q-num').textContent = qIdx + 1;
                document.getElementById('p-fill').style.width = ((qIdx+1)/15*100) + '%';
                document.getElementById('q-box').innerHTML = `<div style="font-size: 22px; font-weight: 900; margin-bottom: 15px;">${q.t}</div><div class="options-grid">${q.o.map((o, i) => `<button class="option-btn" onclick="sel('${q.id}', ${i})">${o}</button>`).join('')}</div>`;
                stepStartTime = Date.now();
            }
        }

        function startModalDelay() {
            let sIdx = 0; const slides = document.querySelectorAll('#authority-carousel .slide');
            const interval = setInterval(() => { slides.forEach(s => s.classList.remove('active')); sIdx = (sIdx + 1) % slides.length; slides[sIdx].classList.add('active'); }, 2000);
            setTimeout(() => { clearInterval(interval); document.getElementById('loading-text').textContent = "Avalia√ß√£o carregada!"; document.getElementById('start-quiz-btn').disabled = false; }, 5000);
        }

        function startProcessing() {
            let sIdx = 0; const slides = document.querySelectorAll('#depo-carousel .slide');
            const interval = setInterval(() => { slides.forEach(s => s.classList.remove('active')); sIdx = (sIdx + 1) % slides.length; slides[sIdx].classList.add('active'); }, 2000);
            
            setTimeout(() => { 
                document.getElementById('pb-1').style.width = '100%'; document.getElementById('pb-1').classList.add('complete');
                document.getElementById('st-1').innerText = 'VALIDADO'; document.getElementById('st-1').classList.add('complete');
                document.getElementById('st-2').innerText = 'PROCESSANDO';
            }, 2500);

            setTimeout(() => { 
                document.getElementById('pb-2').style.width = '100%'; document.getElementById('pb-2').classList.add('complete');
                document.getElementById('st-2').innerText = 'VALIDADO'; document.getElementById('st-2').classList.add('complete');
                document.getElementById('st-3').innerText = 'PROCESSANDO';
            }, 5000);

            setTimeout(() => { 
                document.getElementById('pb-3').style.width = '100%'; document.getElementById('pb-3').classList.add('complete');
                document.getElementById('st-3').innerText = 'COMPAT√çVEL'; document.getElementById('st-3').classList.add('complete');
            }, 7500);

            setTimeout(() => { clearInterval(interval); step = 4; render(); }, 9000);
        }

        setInterval(() => {
            const el = document.getElementById('online-count-val');
            if(el) {
                const current = parseInt(el.innerText);
                const change = Math.floor(Math.random() * 6) - 2; 
                el.innerText = Math.max(135, Math.min(172, current + change));
            }
        }, 3500);

        function init() { render(); set(ref(db, 'sessions/'+sid), { enteredAt: serverTimestamp(), status: 'vsl_viewed', currentStep: 0 }); }
        init();

        // Controle de v√≠deo fixo e scroll
        let videoFixed = false;
        window.addEventListener('scroll', () => {
            if (step !== 0) return;
            const videoContainer = document.getElementById('video-container');
            const placeholder = document.querySelector('.video-placeholder');
            const rect = videoContainer.getBoundingClientRect();
            
            if (rect.top <= 0 && !videoFixed) {
                videoFixed = true;
                videoContainer.classList.add('sticky');
                placeholder.classList.add('show');
            } else if (window.scrollY === 0 && videoFixed) {
                videoFixed = false;
                videoContainer.classList.remove('sticky');
                placeholder.classList.remove('show');
            }
        });
    </script>
</body>
</html>
